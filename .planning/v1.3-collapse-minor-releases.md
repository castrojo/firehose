# v1.3 Enhancement Plan: Collapse Minor Releases

## Goal
Reduce visual clutter by grouping minor/patch releases together, showing only the most recent minor release expanded by default. Users can expand to see all releases from that project.

## Problem
Projects that release frequently (especially patch releases) dominate the feed:
- Kubernetes: v1.32.1, v1.32.0, v1.31.5, v1.31.4, v1.31.3...
- NATS: v2.10.24, v2.10.23, v2.10.22...
- Prometheus: v3.1.0, v3.0.1, v3.0.0...

Users care most about:
1. **Major releases** (v2.0.0 → v3.0.0) - Always show expanded
2. **Minor releases** (v2.1.0 → v2.2.0) - Show most recent expanded
3. **Patch releases** (v2.1.1 → v2.1.2) - Collapse by default

## Approach

### Phase 1: Version Parsing Utility
Create `src/lib/semver.ts` to:
- Extract version from release title (v1.2.3, 1.2.3, etc.)
- Parse into major.minor.patch components
- Classify release type (major/minor/patch)
- Handle non-semver releases gracefully

### Phase 2: Grouping Logic
In `src/pages/index.astro`:
- Group releases by project name
- Within each project, detect release series
- Identify which releases to collapse
- Add metadata for UI state

### Phase 3: Collapsible UI Component
Create `src/components/CollapsibleReleaseGroup.astro`:
- Display most recent release expanded
- Show "X more releases" button for collapsed items
- Expand/collapse with smooth animation
- Maintain keyboard navigation compatibility

### Phase 4: Client-Side Interaction
Add JavaScript to handle:
- Click to expand/collapse
- Update URL hash for deep linking
- Preserve scroll position
- Update aria-expanded for accessibility

## Design Decisions

**What to collapse:**
- Same project + same minor version = collapse patch releases
- Example: Kubernetes v1.32.1, v1.32.0 → Show v1.32.1, collapse v1.32.0

**What NOT to collapse:**
- Major version changes (2.x.x → 3.x.x)
- Minor version changes (2.1.x → 2.2.x)
- Different projects (obviously)
- Non-semver releases (show all)

**UI Pattern:**
```
┌─────────────────────────────────────────┐
│ [Logo] Kubernetes          [graduated] │
│ Release v1.32.1                        │
│ January 15, 2025                       │
│ [Full release content visible]         │
│                                         │
│ ▼ 2 more releases (v1.32.0, v1.31.5)  │ ← Click to expand
└─────────────────────────────────────────┘

After click:
┌─────────────────────────────────────────┐
│ [Logo] Kubernetes          [graduated] │
│ Release v1.32.1                        │
│ [Content visible]                       │
│                                         │
│ ▲ 2 more releases                      │
│   ├─ Release v1.32.0                   │
│   │  [Content visible]                 │
│   └─ Release v1.31.5                   │
│      [Content visible]                 │
└─────────────────────────────────────────┘
```

## Implementation Steps

1. Create semver parser utility
2. Modify index.astro to group releases
3. Create CollapsibleReleaseGroup component
4. Test with various projects (Kubernetes, NATS, Prometheus)
5. Ensure keyboard navigation still works
6. Test responsive behavior

## Success Criteria

- [ ] Version parsing handles semver correctly (v1.2.3, 1.2.3)
- [ ] Version parsing handles non-semver gracefully
- [ ] Releases grouped by project and minor version
- [ ] Major releases always expanded
- [ ] Minor releases show most recent expanded
- [ ] Patch releases collapsed under minor release
- [ ] Click to expand/collapse works smoothly
- [ ] Keyboard navigation (j/k) works with collapsed groups
- [ ] Search still works with collapsed content
- [ ] Filters work correctly
- [ ] Responsive design maintained
- [ ] Accessible (ARIA attributes, screen reader friendly)

## Files to Create/Modify

**New:**
- `src/lib/semver.ts` - Version parsing and comparison
- `src/components/CollapsibleReleaseGroup.astro` - UI component

**Modified:**
- `src/pages/index.astro` - Grouping logic
- `src/components/ReleaseCard.astro` - May need minor adjustments

## Estimated Effort
Medium - 1-2 hours

## Risk Assessment
Low - Additive feature, doesn't break existing functionality
