---
phase: 06-cncf-branding
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - public/logos/
  - src/pages/index.astro
  - src/components/ReleaseCard.astro
autonomous: false

must_haves:
  truths:
    - "Each release card displays project logo next to project name"
    - "Sidebar contains CNCF info box with links to cncf.io and landscape.cncf.io"
    - "Logos render correctly at all responsive breakpoints (320px to 1920px)"
    - "Missing logos fail gracefully without breaking layout"
    - "Site visually identifiable as CNCF ecosystem project"
  artifacts:
    - path: "public/logos/*/icon-color.svg"
      provides: "Project logos for 62 CNCF projects"
      count: "~62 SVG files"
    - path: "src/pages/index.astro"
      provides: "InfoBox integrated in sidebar"
      contains: "<InfoBox"
    - path: "src/components/ReleaseCard.astro"
      provides: "Logo display in release header"
      contains: "getProjectLogo"
  key_links:
    - from: "src/components/ReleaseCard.astro"
      to: "src/lib/logoMapper.ts"
      via: "import statement"
      pattern: "import.*getProjectLogo.*logoMapper"
    - from: "src/components/ReleaseCard.astro"
      to: "public/logos/"
      via: "img src attribute"
      pattern: "src=.*projectLogo"
    - from: "src/pages/index.astro"
      to: "src/components/InfoBox.astro"
      via: "component usage"
      pattern: "<InfoBox"
---

<objective>
Complete CNCF branding integration by downloading project logos, adding InfoBox to sidebar with CNCF links, and integrating logo display into ReleaseCard headers.

Purpose: Makes The Firehose visually recognizable as a CNCF ecosystem project by applying official branding elements (colors, logos, links) throughout the UI. This completes the visual identity transformation started in Plan 06-01.

Output: Fully branded site with CNCF colors, project logos, and ecosystem links. Requires human verification to confirm visual correctness across breakpoints.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-cncf-branding/06-RESEARCH.md
@.planning/phases/06-cncf-branding/06-01-SUMMARY.md
@src/pages/index.astro
@src/components/ReleaseCard.astro
@src/lib/logoMapper.ts
@src/config/feeds.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Download Project Logos from cncf/artwork</name>
  <files>public/logos/</files>
  <action>
Create a script to download icon-color.svg logos for all 62 projects in src/config/feeds.ts from the cncf/artwork repository.

**Approach**:
1. Parse feeds.ts to extract unique project repo paths (org/repo from GitHub URLs)
2. For each project, construct cncf/artwork URL: `https://raw.githubusercontent.com/cncf/artwork/main/projects/{project}/icon/color/icon-color.svg`
3. Download to `public/logos/{project}/icon-color.svg`
4. Handle errors gracefully: If 404, log warning and skip (will use fallback in ReleaseCard)
5. Also create a placeholder.svg for projects without logos (simple gray circle with "?" or project initial)

**Edge cases** (from logoMapper):
- Map 'opa' directory for Open Policy Agent repo
- Map 'tuf' directory for The Update Framework repo
- Map 'in-toto' for in-toto project

**Script location**: Create as temporary Node.js script or bash script with curl. After execution, script can be kept for future updates or deleted.

**Example bash approach**:
```bash
#!/bin/bash
# Extract projects from feeds, download logos
# For each unique project: curl -f -o public/logos/{proj}/icon-color.svg {artwork_url}
```

**Verification**: Count downloaded logos, log any failures.

**Note**: This is build-time setup, not runtime. Once downloaded, logos are static assets.
  </action>
  <verify>
```bash
# Count downloaded logos
find public/logos -name "icon-color.svg" | wc -l

# Check for placeholder
test -f public/logos/placeholder.svg && echo "Placeholder exists"

# Sample check: Verify a known project (e.g., kubernetes)
test -f public/logos/kubernetes/icon-color.svg && echo "Kubernetes logo downloaded"
```
  </verify>
  <done>
public/logos/ directory contains ~62 subdirectories with icon-color.svg files, placeholder.svg exists for missing logos, all logos are valid SVG files that can be served.
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate InfoBox into Sidebar</name>
  <files>src/pages/index.astro</files>
  <action>
Add InfoBox component to the sidebar in src/pages/index.astro, positioned above the Stats section.

**Import statement** (add with other component imports):
```astro
import InfoBox from '../components/InfoBox.astro';
```

**Usage in sidebar** (insert before Stats div):
```astro
<InfoBox 
  title="About" 
  description="The Firehose aggregates release notes from CNCF projects."
  links={[
    { text: 'CNCF Homepage', url: 'https://www.cncf.io/', external: true },
    { text: 'CNCF Landscape', url: 'https://landscape.cncf.io/', external: true },
    { text: 'GitHub Repository', url: 'https://github.com/castrojo/firehose', external: true }
  ]}
/>
```

**Styling adjustment**: Ensure InfoBox has margin-bottom to separate from Stats section (should inherit from existing sidebar spacing).

**Test responsive behavior**: InfoBox should stack correctly on mobile (under 1024px breakpoint where sidebar goes vertical).
  </action>
  <verify>
```bash
# Check InfoBox import
grep "import InfoBox" src/pages/index.astro

# Verify InfoBox usage in sidebar
grep -A 5 "<InfoBox" src/pages/index.astro

# Check external links
grep "cncf.io" src/pages/index.astro
grep "landscape.cncf.io" src/pages/index.astro

# Build should succeed
npm run build
```
  </verify>
  <done>
InfoBox component is imported and rendered in sidebar above Stats, displays About section with links to CNCF homepage and Landscape, external links configured correctly, responsive layout maintained.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add Logo Display to ReleaseCard</name>
  <files>src/components/ReleaseCard.astro</files>
  <action>
Integrate project logo display into ReleaseCard component header, next to the project name.

**Import logoMapper** (add to top imports):
```astro
import { getProjectLogo } from '../lib/logoMapper';
```

**Get logo path** (add in frontmatter logic):
```astro
const projectLogo = getProjectLogo(data.projectName);
```

**Modify release-header div** (add img before project-name span):
```astro
<div class="release-header">
  <img 
    src={projectLogo} 
    alt={`${data.projectName || 'Project'} logo`}
    class="project-logo"
    width="32"
    height="32"
    loading="lazy"
    onerror="this.style.display='none'"
  />
  <span class="project-name">...</span>
  ...
</div>
```

**Add CSS styles** (from research Pattern 4):
```css
.project-logo {
  width: 32px;
  height: 32px;
  flex-shrink: 0;
  border-radius: 4px;
  object-fit: contain; /* Maintain aspect ratio */
}

/* Responsive sizing */
@media (max-width: 480px) {
  .project-logo {
    width: 24px;
    height: 24px;
  }
}

@media (max-width: 320px) {
  .project-logo {
    width: 20px;
    height: 20px;
  }
}
```

**Update .release-header** to use flexbox with gap:
```css
.release-header {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}
```

**Error handling**: The `onerror="this.style.display='none'"` attribute hides missing logos gracefully without breaking layout.
  </action>
  <verify>
```bash
# Check logoMapper import
grep "import.*getProjectLogo" src/components/ReleaseCard.astro

# Verify logo usage
grep "projectLogo" src/components/ReleaseCard.astro

# Check img element with lazy loading
grep -E "(loading=\"lazy\"|onerror)" src/components/ReleaseCard.astro

# Build should succeed
npm run build
```
  </verify>
  <done>
ReleaseCard imports getProjectLogo, displays 32x32 logo next to project name, uses lazy loading for performance, handles missing logos gracefully with onerror, responsive sizing at mobile breakpoints (24px at 480px, 20px at 320px).
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete CNCF branding integration including:
- Official CNCF blue color throughout site (links, accents)
- Project logos displayed in every release card header
- InfoBox in sidebar with links to CNCF homepage and Landscape
- Responsive logo sizing across all breakpoints
  </what-built>
  <how-to-verify>
**Visual verification steps:**

1. **Build and preview**:
   ```bash
   npm run build
   npm run preview
   ```
   Open http://localhost:4321/firehose in browser

2. **Check CNCF color integration**:
   - Links should be CNCF blue (#0086FF)
   - Search bar focus/active states use CNCF blue
   - InfoBox links are CNCF blue
   - Open browser DevTools → Inspect any link → Computed styles should show `color: rgb(0, 134, 255)`

3. **Check project logos**:
   - Scroll through release cards
   - Each card should show a logo next to project name (32x32px)
   - Logos should be colorful SVGs (not grayscale)
   - For any projects without logos, layout should not break (logo hidden, name still visible)
   - Open Network tab, verify logo SVGs load successfully (200 status)

4. **Check InfoBox in sidebar**:
   - Sidebar should have "About" section above Stats
   - Should contain links to: CNCF Homepage, CNCF Landscape, GitHub Repository
   - Links should open in new tab when clicked
   - External icon (small arrow) should appear next to each link

5. **Check responsive behavior**:
   - Desktop (1024px+): Logos are 32x32px, sidebar is left column
   - Tablet (768px-1023px): Sidebar stacks on top, logos still 32x32px
   - Mobile (480px-767px): Logos are 24x24px
   - Tiny screens (320px-479px): Logos are 20x20px
   - Use browser DevTools → Responsive Design Mode to test breakpoints

6. **Check accessibility**:
   - Right-click logo → Inspect → alt attribute should be "{Project Name} logo"
   - Links in InfoBox should have proper focus states (keyboard navigation)
   - External links should have rel="noopener noreferrer"

7. **Check for errors**:
   - Browser console should have no JavaScript errors
   - Network tab should show no 404s for logos (or only a few for projects without logos)
   - Page should feel fast and responsive (lazy loading working)

**Expected outcomes:**
- ✓ CNCF blue appears consistently (links, accents, InfoBox)
- ✓ ~60+ project logos display correctly in cards
- ✓ InfoBox renders in sidebar with 3 external links
- ✓ Responsive sizing works at 320px, 480px, 768px, 1024px+
- ✓ No layout breaks or console errors
- ✓ Site feels professional and CNCF-branded
  </how-to-verify>
  <resume-signal>
Type "approved" if branding looks correct across all breakpoints and logos display properly.

If issues found, describe what's wrong (e.g., "logos too small on mobile", "InfoBox links not blue", "missing logos for X projects").
  </resume-signal>
</task>

</tasks>

<verification>
**Build verification:**
```bash
npm run build
npm run preview
```

**Visual checks:**
- Project logos appear in release cards
- InfoBox displays in sidebar with CNCF links
- CNCF blue color used throughout site
- Responsive behavior correct at 320px, 480px, 768px, 1024px, 1920px

**Performance checks:**
- Logos use lazy loading (loading="lazy")
- Page load time remains under 2 seconds
- No blocking logo loads

**Accessibility checks:**
- All logos have alt text
- InfoBox links have proper attributes (target, rel)
- Keyboard navigation works with CNCF blue focus states
</verification>

<success_criteria>
- [ ] ~62 project logos downloaded to public/logos/
- [ ] Placeholder.svg exists for projects without logos
- [ ] InfoBox component integrated into sidebar above Stats
- [ ] InfoBox displays CNCF Homepage, Landscape, GitHub links
- [ ] ReleaseCard imports and uses getProjectLogo
- [ ] Logos display at 32px (desktop), 24px (mobile), 20px (tiny screens)
- [ ] Missing logos fail gracefully (hidden, not broken)
- [ ] CNCF blue color appears in links and accents
- [ ] Build succeeds with no errors
- [ ] Human verifies visual correctness and responsive behavior
- [ ] Site visually recognizable as CNCF ecosystem project
</success_criteria>

<output>
After completion, create `.planning/phases/06-cncf-branding/06-02-SUMMARY.md`
</output>
